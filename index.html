<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Gene Expression FITB Quiz</title>

    <!-- React + Babel (same style as your other GitHub quizzes) -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Tailwind CDN for quick styling -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
      }

      input[type="text"] {
        outline: none;
      }
    </style>
  </head>
  <body class="bg-slate-100 min-h-screen flex items-center justify-center">
    <div id="root"></div>

    <script type="text/babel">
      const QUESTIONS = [
        {
          id: 1,
          label: "1",
          prompt:
            "Label 1: In the cytoplasm, an extracellular ______ triggers a pathway that can regulate gene expression in the nucleus.",
          answers: ["signal", "signaling molecule", "signalling molecule"],
        },
        {
          id: 2,
          label: "2",
          prompt:
            "Label 2: Chromatin modification such as ______ of histones can loosen chromatin and make DNA more available for transcription.",
          answers: ["acetylation", "histone acetylation", "acetylation of histones"],
        },
        {
          id: 3,
          label: "3",
          prompt:
            "Label 3: The step where DNA is used as a template to make RNA is called ________.",
          answers: ["transcription"],
        },
        {
          id: 4,
          label: "4",
          prompt:
            "Label 4: The step where mRNA is used as a template to build a polypeptide is called ________.",
          answers: ["translation"],
        },
        {
          id: 5,
          label: "5",
          prompt:
            "Label 5: Some proteins must undergo post-translational ________ (for example, cleavage or chemical change) before they become active.",
          answers: [
            "modification",
            "processing",
            "post-translational modification",
            "posttranslational modification",
          ],
        },
      ];

      function normalize(text) {
        return text.trim().toLowerCase();
      }

      function GeneExpressionFitbQuiz() {
        const [responses, setResponses] = React.useState(
          () =>
            QUESTIONS.reduce((acc, q) => {
              acc[q.id] = "";
              return acc;
            }, {})
        );

        const [checked, setChecked] = React.useState(false);
        const [results, setResults] = React.useState({});
        const [score, setScore] = React.useState(0);

        const handleChange = (id, value) => {
          setResponses((prev) => ({ ...prev, [id]: value }));
          setChecked(false); // reset results if editing
        };

        const handleCheckAnswers = () => {
          let correctCount = 0;
          const newResults = {};

          QUESTIONS.forEach((q) => {
            const userAnswer = normalize(responses[q.id] || "");
            const isCorrect = q.answers.some(
              (ans) => normalize(ans) === userAnswer
            );
            newResults[q.id] = isCorrect;
            if (isCorrect) correctCount += 1;
          });

          setResults(newResults);
          setScore(correctCount);
          setChecked(true);
        };

        const allFilled = QUESTIONS.every(
          (q) => (responses[q.id] || "").trim().length > 0
        );

        return (
          <div className="max-w-4xl w-full bg-white shadow-lg rounded-xl p-6 md:p-8 space-y-6">
            <h1 className="text-2xl md:text-3xl font-bold text-center text-slate-800 mb-4">
              Eukaryotic Gene Expression – FITB Quiz
            </h1>

            {/* Image above the questions */}
            <div className="w-full flex justify-center mb-4">
              <img
                src="images/eukaryote-transcription-translation.png"
                alt="Eukaryotic gene expression diagram with labels 1–5"
                className="max-h-[420px] w-auto border rounded-lg shadow-sm"
              />
            </div>

            <p className="text-sm text-slate-600 text-center mb-4">
              Use the diagram above to answer each fill-in-the-blank question.
              Answers are not case-sensitive.
            </p>

            <div className="space-y-4">
              {QUESTIONS.map((q) => {
                const value = responses[q.id] || "";
                const isCorrect = results[q.id];
                const isIncorrect =
                  checked && value.trim().length > 0 && !isCorrect;

                return (
                  <div
                    key={q.id}
                    className="border rounded-lg p-4 bg-slate-50 flex flex-col gap-2"
                  >
                    <div className="flex items-center gap-2">
                      <span className="inline-flex items-center justify-center w-7 h-7 rounded-full bg-indigo-600 text-white text-sm font-semibold">
                        {q.label}
                      </span>
                      <span className="text-sm text-slate-700">
                        (Label {q.label} in the figure)
                      </span>
                    </div>
                    <p className="text-slate-800 text-sm md:text-base">
                      {q.prompt}
                    </p>
                    <input
                      type="text"
                      value={value}
                      onChange={(e) => handleChange(q.id, e.target.value)}
                      className={`mt-1 w-full rounded-md border px-3 py-2 text-sm md:text-base bg-white ${
                        isCorrect
                          ? "border-emerald-500 ring-1 ring-emerald-300"
                          : isIncorrect
                          ? "border-rose-500 ring-1 ring-rose-300"
                          : "border-slate-300"
                      }`}
                      placeholder="Type your answer here"
                    />
                    {checked && (
                      <div className="text-xs md:text-sm">
                        {isCorrect ? (
                          <span className="text-emerald-600 font-semibold">
                            ✔ Correct
                          </span>
                        ) : (
                          <span className="text-rose-600">
                            ✘ Incorrect. One acceptable answer:{' '}
                            <span className="font-semibold">
                              {QUESTIONS.find((x) => x.id === q.id).answers[0]}
                            </span>
                          </span>
                        )}
                      </div>
                    )}
                  </div>
                );
              })}
            </div>

            <div className="flex flex-col md:flex-row items-center justify-between gap-3 mt-4">
              <button
                onClick={handleCheckAnswers}
                disabled={!allFilled}
                className={`px-5 py-2.5 rounded-md text-sm font-semibold text-white shadow-sm transition ${
                  allFilled
                    ? "bg-indigo-600 hover:bg-indigo-700"
                    : "bg-slate-400 cursor-not-allowed"
                }`}
              >
                Check Answers
              </button>

              {checked && (
                <div className="text-sm md:text-base font-semibold text-slate-800">
                  Score: {score} / {QUESTIONS.length}
                </div>
              )}
            </div>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<GeneExpressionFitbQuiz />);
    </script>
  </body>
</html>
